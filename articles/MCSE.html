<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation Performance Criteria and MCSE • simhelpers</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Simulation Performance Criteria and MCSE">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simhelpers</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MCSE.html">Simulation Performance Criteria and MCSE</a>
    </li>
    <li>
      <a href="../articles/simulation_workflow.html">Simulation Workflow</a>
    </li>
    <li>
      <a href="../articles/visualization.html">Presenting Results from Simulation Studies</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MCSE_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Simulation Performance Criteria and MCSE</h1>
            
      
      
      <div class="hidden name"><code>MCSE.Rmd</code></div>

    </div>

    
    
<div id="introduction-to-simulation-studies-and-monte-carlo-standard-errors" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction-to-simulation-studies-and-monte-carlo-standard-errors" class="anchor"></a>Introduction to Simulation Studies and Monte Carlo Standard Errors</h1>
<p>Simulations are experiments to study the performance of statistical methods under known data-generating conditions (Morris, White and Crowther, 2018). Methodologists examine questions like: (1) how does ordinary least squares (OLS) regression perform if errors are heteroskedastic? (2) how does the presence of missing data affect treatment effect estimates from a propensity score analysis? (3) how does robust variance estimation perform when sample size is small? To answer such questions, we conduct experiments by simulating thousands of datasets from pseudo-random sampling (Morris et al., 2018). We generate datasets under known conditions. For example, we can generate data where the errors are heteroskedastic or there is missing data present following Missing at Random (MAR) mechanism. Then, we apply statistical methods, like OLS or propensity score estimation using logistic regression, to each of the datasets and extract measures like regression coefficients, p-values, and confidence intervals. We then analyze the methods using performance criteria measures like bias, Type 1 error rate or root mean squared error.</p>
<p>When examining performance measures, we need to also consider the error in the estimate of the performance measures due to the fact that we generate a finite number of samples. The error is quantified in the form of Monte Carlo standard error (MCSE).</p>
<p>The goal of <code>simhelpers</code> is to assist in running simulation studies. This package provides a set of functions that calculates various performance measures and associated MCSE. This vignette focuses on the set of functions. Below, we explain three major categories of performance criteria: (1) absolute criteria, (2) relative criteria, and (3) criteria to evaluate hypothesis testing. We provide formulas used to calculate the performance measures and MCSE and demonstrate how to use the functions in the <code>simhelpers</code> package.</p>
<p>The formula notations and explanations of the performance measures follow notes from Dr. James Pustejovsky’s <a href="https://www.jepusto.com/teaching/daspir/">Data Analysis, Simulation and Programming in R course (Spring, 2019)</a>.</p>
</div>
<div id="performance-criteria-and-mcse" class="section level1">
<h1 class="hasAnchor">
<a href="#performance-criteria-and-mcse" class="anchor"></a>Performance Criteria and MCSE</h1>
<div id="absolute-criteria" class="section level2">
<h2 class="hasAnchor">
<a href="#absolute-criteria" class="anchor"></a>Absolute Criteria</h2>
<p>Bias characterizes whether the estimate on average lies above or below the true parameter. Variance characterizes the precision of the estimates. It characterizes the deviation of each estimate from the average of the estimates. Note that variance is the inverse of precision. Therefore, the higher the variance, the lower the precision. Mean squared error (MSE) and root mean squared error (RMSE) characterize the accuracy of the estimates. MSE and RMSE measure how far off on average the estimates are from the true parameter. Absolute criteria are in the same scale as the estimates. MSE is in squared deviation scale and RMSE is in the scale of the estimates.</p>
<p>Let <span class="math inline">\(T\)</span> denote an estimator for a parameter <span class="math inline">\(\theta\)</span>. From running a simulation study, we obtain <span class="math inline">\(K\)</span> iterations of the estimates <span class="math inline">\(T_1,...,T_K\)</span> for each data generating condition. We can calculate the following sample statistics for the estimates:</p>
<ul>
<li>Sample mean: <span class="math inline">\(\bar{T} = \frac{1}{K}\sum_{k=1}^K T_k\)</span>
</li>
<li>Sample variance: <span class="math inline">\(S_T^2 = \frac{1}{K - 1}\sum_{k=1}^K \left(T_k - \bar{T}\right)^2\)</span>
</li>
<li>Sample skewness (standardized): <span class="math inline">\(g_T = \frac{1}{K S_T^3}\sum_{k=1}^K \left(T_k - \bar{T}\right)^3\)</span>
</li>
<li>Sample kurtosis (standardized): <span class="math inline">\(k_T = \frac{1}{K S_T^4} \sum_{k=1}^K \left(T_k - \bar{T}\right)^4\)</span>
</li>
</ul>
<p>The table below shows each of the performance criteria, what it measures, its definition, its estimate, and its MCSE formula.</p>
<table class="table table table-striped table-hover">
<caption>
Table 1. Absolute Performance Criteria
</caption>
<thead><tr>
<th style="text-align:left;">
Criterion
</th>
<th style="text-align:left;">
Measure
</th>
<th style="text-align:left;">
Definition
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:left;">
MCSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Bias
</td>
<td style="text-align:left;">
Difference from true parameter
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}(T) - \theta\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\bar{T} - \theta\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{S_T^2/ K}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Variance
</td>
<td style="text-align:left;">
Precision
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}\left[(T - \text{E}(T))^2\right]\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(S_T^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(S_T^2 \sqrt{\frac{k_T - 1}{K}}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
MSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}\left[(T - \theta)^2\right]\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{1}{K}\sum_{k=1}^{K}\left(T_k - \theta\right)^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K}\left[S_T^4 (k_T - 1) + 4 S_T^3 g_T(\bar{T} - \theta) + 4 S_T^2 (\bar{T} - \theta)^2\right]}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\text{E}\left[(T - \theta)^2\right]}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K}\sum_{k=1}^{K}\left(T_k - \theta\right)^2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K} \sum_{j=1}^K \left(RMSE_{(j)} - RMSE)^2\right)}\)</span>
</td>
</tr>
</tbody>
</table>
<p>The equation for the MCSE of RMSE is derived using the jackknife technique, which involves excluding a replicate <span class="math inline">\(j\)</span> and calculating RMSE. The formula for RMSE is:</p>
<p><span class="math display">\[\sqrt{\frac{1}{K}\sum_{k=1}^{K}\left(T_k - \theta\right)^2}\]</span></p>
<p>This is approximately equivalent to:</p>
<p><span class="math display">\[RMSE = \sqrt{(\bar{T} - \theta)^2 + S^2_T}\]</span></p>
<p>The jackknife RMSE will be calculated as:</p>
<p><span class="math display">\[RMSE_{(j)}  = \sqrt{(\bar{T}_{(j)} - \theta)^2 + S^2_{T(j)}}\]</span></p>
<p>Here <span class="math inline">\(\bar{T}_{(j)}\)</span> and <span class="math inline">\(S^2_{T(j)}\)</span> indicate the mean and variance of the estimates leaving replicate <span class="math inline">\(j\)</span> out. Instead of calculating each jackknife estimate, we use algebra tricks to calculate <span class="math inline">\(\bar{T}_{(j)}\)</span> and <span class="math inline">\(S^2_{T(j)}\)</span> as follows:</p>
<p><span class="math display">\[\bar{T}_{(j)} = \frac{1}{K-1} \left(K \bar{T} - T_j\right)\]</span></p>
<p><span class="math display">\[S_{T(j)}^2 = \frac{1}{K - 2} \left[(K - 1) S_T^2 - \frac{K}{K - 1}\left(T_j - \bar{T}\right)^2\right]\]</span></p>
<p>Then, the jacknife MCSE of RMSE will be calculated as:</p>
<p><span class="math display">\[MCSE_{RMSE(JK)}  = \sqrt{\frac{1}{K}\sum_{j=1}^K  \left(RMSE_{(j)} - RMSE\right)^2}\]</span></p>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<p>We use the <code>welch_res</code> dataset included in the package. It contains the results from an example simulation study comparing the heteroskedasticity robust Welch t-test to normal t-test. The code used to generate the data and derive results can be found <a href="https://github.com/meghapsimatrix/simhelpers/blob/master/data-raw/welch_res_dat.R">here</a>. We varied the mean difference parameter when generating data for two groups. We set the values to 0, 0.5, 1 and 2. We also varied the sample size per group, setting sample size values to 50, 100, and 200. We generated the data with slightly unequal variances. With each simulated data, we ran normal t-test, which assumes homogeneity of variance, and we also ran Welch t-test which does not assume homogeneity of variance. We extracted the estimate (mean difference), variance of the estimates, p-value, and the upper and lower bounds of the confidence intervals.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(simhelpers)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tibble)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kableExtra)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">welch_res <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>()</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; Observations: 24,000</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; Variables: 10</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; $ n           &lt;dbl&gt; 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 5…</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; $ mean_diff   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; $ iterations  &lt;dbl&gt; 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 100…</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; $ seed        &lt;dbl&gt; 204809087, 204809087, 204809087, 204809087, 204809087, 20…</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; $ method      &lt;chr&gt; "t-test", "Welch t-test", "t-test", "Welch t-test", "t-te…</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt; $ est         &lt;dbl&gt; 0.025836000, 0.025836000, 0.005158587, 0.005158587, -0.07…</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt; $ var         &lt;dbl&gt; 0.09543914, 0.09543914, 0.08481717, 0.08481717, 0.0817933…</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt; $ p_val       &lt;dbl&gt; 0.9335212, 0.9335804, 0.9859039, 0.9859109, 0.7807543, 0.…</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; $ lower_bound &lt;dbl&gt; -0.5872300, -0.5899041, -0.5727856, -0.5741984, -0.647370…</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; $ upper_bound &lt;dbl&gt; 0.6389020, 0.6415761, 0.5831027, 0.5845155, 0.4877263, 0.…</span></a></code></pre></div>
<p>Below, we calculate the absolute performance criteria for the estimate of the mean difference. We present the results by sample size, mean difference, and the t-test method. The <code><a href="../reference/calc_absolute.html">calc_absolute()</a></code> function is designed to work with the <a href="https://tidyeval.tidyverse.org/index.html"><code>tidyeval</code></a> workflow. The first argument, <code>res_dat</code>, requires a data frame or a tibble containing the results from a simulation study. The second argument, <code>estimates</code>, requires the name of the column containing the estimates like mean difference or regression coefficients. The third argument, <code>true_param</code>, requires the name of the column containing the true parameters. The fourth argument <code>perfm_criteria</code> lets the user specify which criteria to evaluate. The criteria can be specified using a character or character vector. If the user only wants bias, they can specify <code>perfm_criteria = "bias"</code>. If the user wants bias and root mean squared error, they can specify <code>perfm_criteria = c("bias", "rmse")</code>. By default, the function returns, bias, variance, mean squared error (mse), and root mean squared error (rmse), <code>perfm_criteria = c("bias", "variance", "mse", "rmse")</code>. In the example below, we ask for all the available criteria.</p>
<p>We use <code>dplyr</code> syntax to group by the sample size and mean difference that were used to generate the data, and the method used to analyze the data. We provide examples using <a href="https://dplyr.tidyverse.org/reference/do.html"><code><a href="https://dplyr.tidyverse.org/reference/do.html">do()</a></code></a> and <a href="https://dplyr.tidyverse.org/reference/group_map.html"><code><a href="https://dplyr.tidyverse.org/reference/group_map.html">group_modify()</a></code></a> to run <code><a href="../reference/calc_absolute.html">calc_absolute()</a></code> on results for each combination of the conditions. We round the results to five decimal places.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># using do()</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">welch_res <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(n, mean_diff, method) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># grouping </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/do.html">do</a></span>(<span class="kw"><a href="../reference/calc_absolute.html">calc_absolute</a></span>(.,  <span class="dt">estimates =</span> est, <span class="dt">true_param =</span> mean_diff)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># run the function</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="dt">digits =</span> <span class="dv">5</span>) <span class="co"># create a kable table </span></a></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean_diff
</th>
<th style="text-align:left;">
method
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
bias_mcse
</th>
<th style="text-align:right;">
var
</th>
<th style="text-align:right;">
var_mcse
</th>
<th style="text-align:right;">
mse
</th>
<th style="text-align:right;">
mse_mcse
</th>
<th style="text-align:right;">
rmse
</th>
<th style="text-align:right;">
rmse_mcse
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00890
</td>
<td style="text-align:right;">
0.01000
</td>
<td style="text-align:right;">
0.09999
</td>
<td style="text-align:right;">
0.00425
</td>
<td style="text-align:right;">
0.09997
</td>
<td style="text-align:right;">
0.00425
</td>
<td style="text-align:right;">
0.31618
</td>
<td style="text-align:right;">
0.00027
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00890
</td>
<td style="text-align:right;">
0.01000
</td>
<td style="text-align:right;">
0.09999
</td>
<td style="text-align:right;">
0.00425
</td>
<td style="text-align:right;">
0.09997
</td>
<td style="text-align:right;">
0.00425
</td>
<td style="text-align:right;">
0.31618
</td>
<td style="text-align:right;">
0.00027
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00449
</td>
<td style="text-align:right;">
0.01025
</td>
<td style="text-align:right;">
0.10512
</td>
<td style="text-align:right;">
0.00468
</td>
<td style="text-align:right;">
0.10503
</td>
<td style="text-align:right;">
0.00468
</td>
<td style="text-align:right;">
0.32409
</td>
<td style="text-align:right;">
0.00028
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00449
</td>
<td style="text-align:right;">
0.01025
</td>
<td style="text-align:right;">
0.10512
</td>
<td style="text-align:right;">
0.00468
</td>
<td style="text-align:right;">
0.10503
</td>
<td style="text-align:right;">
0.00468
</td>
<td style="text-align:right;">
0.32409
</td>
<td style="text-align:right;">
0.00028
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00725
</td>
<td style="text-align:right;">
0.00981
</td>
<td style="text-align:right;">
0.09631
</td>
<td style="text-align:right;">
0.00440
</td>
<td style="text-align:right;">
0.09627
</td>
<td style="text-align:right;">
0.00439
</td>
<td style="text-align:right;">
0.31028
</td>
<td style="text-align:right;">
0.00027
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00725
</td>
<td style="text-align:right;">
0.00981
</td>
<td style="text-align:right;">
0.09631
</td>
<td style="text-align:right;">
0.00440
</td>
<td style="text-align:right;">
0.09627
</td>
<td style="text-align:right;">
0.00439
</td>
<td style="text-align:right;">
0.31028
</td>
<td style="text-align:right;">
0.00027
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00565
</td>
<td style="text-align:right;">
0.00964
</td>
<td style="text-align:right;">
0.09290
</td>
<td style="text-align:right;">
0.00407
</td>
<td style="text-align:right;">
0.09284
</td>
<td style="text-align:right;">
0.00408
</td>
<td style="text-align:right;">
0.30470
</td>
<td style="text-align:right;">
0.00026
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00565
</td>
<td style="text-align:right;">
0.00964
</td>
<td style="text-align:right;">
0.09290
</td>
<td style="text-align:right;">
0.00407
</td>
<td style="text-align:right;">
0.09284
</td>
<td style="text-align:right;">
0.00408
</td>
<td style="text-align:right;">
0.30470
</td>
<td style="text-align:right;">
0.00026
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00934
</td>
<td style="text-align:right;">
0.00703
</td>
<td style="text-align:right;">
0.04945
</td>
<td style="text-align:right;">
0.00212
</td>
<td style="text-align:right;">
0.04949
</td>
<td style="text-align:right;">
0.00211
</td>
<td style="text-align:right;">
0.22245
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00934
</td>
<td style="text-align:right;">
0.00703
</td>
<td style="text-align:right;">
0.04945
</td>
<td style="text-align:right;">
0.00212
</td>
<td style="text-align:right;">
0.04949
</td>
<td style="text-align:right;">
0.00211
</td>
<td style="text-align:right;">
0.22245
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00536
</td>
<td style="text-align:right;">
0.00721
</td>
<td style="text-align:right;">
0.05205
</td>
<td style="text-align:right;">
0.00235
</td>
<td style="text-align:right;">
0.05203
</td>
<td style="text-align:right;">
0.00235
</td>
<td style="text-align:right;">
0.22810
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00536
</td>
<td style="text-align:right;">
0.00721
</td>
<td style="text-align:right;">
0.05205
</td>
<td style="text-align:right;">
0.00235
</td>
<td style="text-align:right;">
0.05203
</td>
<td style="text-align:right;">
0.00235
</td>
<td style="text-align:right;">
0.22810
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00947
</td>
<td style="text-align:right;">
0.00723
</td>
<td style="text-align:right;">
0.05225
</td>
<td style="text-align:right;">
0.00234
</td>
<td style="text-align:right;">
0.05229
</td>
<td style="text-align:right;">
0.00236
</td>
<td style="text-align:right;">
0.22866
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00947
</td>
<td style="text-align:right;">
0.00723
</td>
<td style="text-align:right;">
0.05225
</td>
<td style="text-align:right;">
0.00234
</td>
<td style="text-align:right;">
0.05229
</td>
<td style="text-align:right;">
0.00236
</td>
<td style="text-align:right;">
0.22866
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00261
</td>
<td style="text-align:right;">
0.00730
</td>
<td style="text-align:right;">
0.05332
</td>
<td style="text-align:right;">
0.00232
</td>
<td style="text-align:right;">
0.05328
</td>
<td style="text-align:right;">
0.00232
</td>
<td style="text-align:right;">
0.23082
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00261
</td>
<td style="text-align:right;">
0.00730
</td>
<td style="text-align:right;">
0.05332
</td>
<td style="text-align:right;">
0.00232
</td>
<td style="text-align:right;">
0.05328
</td>
<td style="text-align:right;">
0.00232
</td>
<td style="text-align:right;">
0.23082
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00134
</td>
<td style="text-align:right;">
0.00508
</td>
<td style="text-align:right;">
0.02585
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.02583
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.16072
</td>
<td style="text-align:right;">
0.00014
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00134
</td>
<td style="text-align:right;">
0.00508
</td>
<td style="text-align:right;">
0.02585
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.02583
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.16072
</td>
<td style="text-align:right;">
0.00014
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00115
</td>
<td style="text-align:right;">
0.00498
</td>
<td style="text-align:right;">
0.02478
</td>
<td style="text-align:right;">
0.00105
</td>
<td style="text-align:right;">
0.02475
</td>
<td style="text-align:right;">
0.00105
</td>
<td style="text-align:right;">
0.15734
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00115
</td>
<td style="text-align:right;">
0.00498
</td>
<td style="text-align:right;">
0.02478
</td>
<td style="text-align:right;">
0.00105
</td>
<td style="text-align:right;">
0.02475
</td>
<td style="text-align:right;">
0.00105
</td>
<td style="text-align:right;">
0.15734
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.01105
</td>
<td style="text-align:right;">
0.00504
</td>
<td style="text-align:right;">
0.02543
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.02553
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.15979
</td>
<td style="text-align:right;">
0.00014
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.01105
</td>
<td style="text-align:right;">
0.00504
</td>
<td style="text-align:right;">
0.02543
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.02553
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.15979
</td>
<td style="text-align:right;">
0.00014
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00577
</td>
<td style="text-align:right;">
0.00490
</td>
<td style="text-align:right;">
0.02397
</td>
<td style="text-align:right;">
0.00103
</td>
<td style="text-align:right;">
0.02398
</td>
<td style="text-align:right;">
0.00103
</td>
<td style="text-align:right;">
0.15486
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00577
</td>
<td style="text-align:right;">
0.00490
</td>
<td style="text-align:right;">
0.02397
</td>
<td style="text-align:right;">
0.00103
</td>
<td style="text-align:right;">
0.02398
</td>
<td style="text-align:right;">
0.00103
</td>
<td style="text-align:right;">
0.15486
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># using group_modify()</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">welch_res <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">params =</span> mean_diff) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># group_modify cannot take in a group column as an argument</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(n, mean_diff, method) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_map.html">group_modify</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/calc_absolute.html">calc_absolute</a></span>(.x,  <span class="dt">estimates =</span> est, <span class="dt">true_param =</span> params)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="dt">digits =</span> <span class="dv">5</span>)</a></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean_diff
</th>
<th style="text-align:left;">
method
</th>
<th style="text-align:right;">
bias
</th>
<th style="text-align:right;">
bias_mcse
</th>
<th style="text-align:right;">
var
</th>
<th style="text-align:right;">
var_mcse
</th>
<th style="text-align:right;">
mse
</th>
<th style="text-align:right;">
mse_mcse
</th>
<th style="text-align:right;">
rmse
</th>
<th style="text-align:right;">
rmse_mcse
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00890
</td>
<td style="text-align:right;">
0.01000
</td>
<td style="text-align:right;">
0.09999
</td>
<td style="text-align:right;">
0.00425
</td>
<td style="text-align:right;">
0.09997
</td>
<td style="text-align:right;">
0.00425
</td>
<td style="text-align:right;">
0.31618
</td>
<td style="text-align:right;">
0.00027
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00890
</td>
<td style="text-align:right;">
0.01000
</td>
<td style="text-align:right;">
0.09999
</td>
<td style="text-align:right;">
0.00425
</td>
<td style="text-align:right;">
0.09997
</td>
<td style="text-align:right;">
0.00425
</td>
<td style="text-align:right;">
0.31618
</td>
<td style="text-align:right;">
0.00027
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00449
</td>
<td style="text-align:right;">
0.01025
</td>
<td style="text-align:right;">
0.10512
</td>
<td style="text-align:right;">
0.00468
</td>
<td style="text-align:right;">
0.10503
</td>
<td style="text-align:right;">
0.00468
</td>
<td style="text-align:right;">
0.32409
</td>
<td style="text-align:right;">
0.00028
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00449
</td>
<td style="text-align:right;">
0.01025
</td>
<td style="text-align:right;">
0.10512
</td>
<td style="text-align:right;">
0.00468
</td>
<td style="text-align:right;">
0.10503
</td>
<td style="text-align:right;">
0.00468
</td>
<td style="text-align:right;">
0.32409
</td>
<td style="text-align:right;">
0.00028
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00725
</td>
<td style="text-align:right;">
0.00981
</td>
<td style="text-align:right;">
0.09631
</td>
<td style="text-align:right;">
0.00440
</td>
<td style="text-align:right;">
0.09627
</td>
<td style="text-align:right;">
0.00439
</td>
<td style="text-align:right;">
0.31028
</td>
<td style="text-align:right;">
0.00027
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00725
</td>
<td style="text-align:right;">
0.00981
</td>
<td style="text-align:right;">
0.09631
</td>
<td style="text-align:right;">
0.00440
</td>
<td style="text-align:right;">
0.09627
</td>
<td style="text-align:right;">
0.00439
</td>
<td style="text-align:right;">
0.31028
</td>
<td style="text-align:right;">
0.00027
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00565
</td>
<td style="text-align:right;">
0.00964
</td>
<td style="text-align:right;">
0.09290
</td>
<td style="text-align:right;">
0.00407
</td>
<td style="text-align:right;">
0.09284
</td>
<td style="text-align:right;">
0.00408
</td>
<td style="text-align:right;">
0.30470
</td>
<td style="text-align:right;">
0.00026
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00565
</td>
<td style="text-align:right;">
0.00964
</td>
<td style="text-align:right;">
0.09290
</td>
<td style="text-align:right;">
0.00407
</td>
<td style="text-align:right;">
0.09284
</td>
<td style="text-align:right;">
0.00408
</td>
<td style="text-align:right;">
0.30470
</td>
<td style="text-align:right;">
0.00026
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00934
</td>
<td style="text-align:right;">
0.00703
</td>
<td style="text-align:right;">
0.04945
</td>
<td style="text-align:right;">
0.00212
</td>
<td style="text-align:right;">
0.04949
</td>
<td style="text-align:right;">
0.00211
</td>
<td style="text-align:right;">
0.22245
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00934
</td>
<td style="text-align:right;">
0.00703
</td>
<td style="text-align:right;">
0.04945
</td>
<td style="text-align:right;">
0.00212
</td>
<td style="text-align:right;">
0.04949
</td>
<td style="text-align:right;">
0.00211
</td>
<td style="text-align:right;">
0.22245
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00536
</td>
<td style="text-align:right;">
0.00721
</td>
<td style="text-align:right;">
0.05205
</td>
<td style="text-align:right;">
0.00235
</td>
<td style="text-align:right;">
0.05203
</td>
<td style="text-align:right;">
0.00235
</td>
<td style="text-align:right;">
0.22810
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00536
</td>
<td style="text-align:right;">
0.00721
</td>
<td style="text-align:right;">
0.05205
</td>
<td style="text-align:right;">
0.00235
</td>
<td style="text-align:right;">
0.05203
</td>
<td style="text-align:right;">
0.00235
</td>
<td style="text-align:right;">
0.22810
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00947
</td>
<td style="text-align:right;">
0.00723
</td>
<td style="text-align:right;">
0.05225
</td>
<td style="text-align:right;">
0.00234
</td>
<td style="text-align:right;">
0.05229
</td>
<td style="text-align:right;">
0.00236
</td>
<td style="text-align:right;">
0.22866
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00947
</td>
<td style="text-align:right;">
0.00723
</td>
<td style="text-align:right;">
0.05225
</td>
<td style="text-align:right;">
0.00234
</td>
<td style="text-align:right;">
0.05229
</td>
<td style="text-align:right;">
0.00236
</td>
<td style="text-align:right;">
0.22866
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00261
</td>
<td style="text-align:right;">
0.00730
</td>
<td style="text-align:right;">
0.05332
</td>
<td style="text-align:right;">
0.00232
</td>
<td style="text-align:right;">
0.05328
</td>
<td style="text-align:right;">
0.00232
</td>
<td style="text-align:right;">
0.23082
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00261
</td>
<td style="text-align:right;">
0.00730
</td>
<td style="text-align:right;">
0.05332
</td>
<td style="text-align:right;">
0.00232
</td>
<td style="text-align:right;">
0.05328
</td>
<td style="text-align:right;">
0.00232
</td>
<td style="text-align:right;">
0.23082
</td>
<td style="text-align:right;">
0.00020
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00134
</td>
<td style="text-align:right;">
0.00508
</td>
<td style="text-align:right;">
0.02585
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.02583
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.16072
</td>
<td style="text-align:right;">
0.00014
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00134
</td>
<td style="text-align:right;">
0.00508
</td>
<td style="text-align:right;">
0.02585
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.02583
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.16072
</td>
<td style="text-align:right;">
0.00014
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.00115
</td>
<td style="text-align:right;">
0.00498
</td>
<td style="text-align:right;">
0.02478
</td>
<td style="text-align:right;">
0.00105
</td>
<td style="text-align:right;">
0.02475
</td>
<td style="text-align:right;">
0.00105
</td>
<td style="text-align:right;">
0.15734
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.00115
</td>
<td style="text-align:right;">
0.00498
</td>
<td style="text-align:right;">
0.02478
</td>
<td style="text-align:right;">
0.00105
</td>
<td style="text-align:right;">
0.02475
</td>
<td style="text-align:right;">
0.00105
</td>
<td style="text-align:right;">
0.15734
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
-0.01105
</td>
<td style="text-align:right;">
0.00504
</td>
<td style="text-align:right;">
0.02543
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.02553
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.15979
</td>
<td style="text-align:right;">
0.00014
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
-0.01105
</td>
<td style="text-align:right;">
0.00504
</td>
<td style="text-align:right;">
0.02543
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.02553
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.15979
</td>
<td style="text-align:right;">
0.00014
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.00577
</td>
<td style="text-align:right;">
0.00490
</td>
<td style="text-align:right;">
0.02397
</td>
<td style="text-align:right;">
0.00103
</td>
<td style="text-align:right;">
0.02398
</td>
<td style="text-align:right;">
0.00103
</td>
<td style="text-align:right;">
0.15486
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.00577
</td>
<td style="text-align:right;">
0.00490
</td>
<td style="text-align:right;">
0.02397
</td>
<td style="text-align:right;">
0.00103
</td>
<td style="text-align:right;">
0.02398
</td>
<td style="text-align:right;">
0.00103
</td>
<td style="text-align:right;">
0.15486
</td>
<td style="text-align:right;">
0.00013
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="relative-criteria" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-criteria" class="anchor"></a>Relative Criteria</h2>
<p>Relative criteria can be useful to look at if multiple true parameter values are used to generate the data to run the simulation and if performance measure changes according to the true value. It can be only used when <span class="math inline">\(|\theta| &gt; 0\)</span> as we cannot divide by <span class="math inline">\(0\)</span> (Morris et al., 2018).</p>
<p>To derive the MCSE for relative RMSE, we again used the jackknife technique. The formula to calculate relative RMSE is:</p>
<p><span class="math display">\[RMSE = \sqrt{\frac{(\bar{T} - \theta)^2 + S_T^2}{\theta^2}}\]</span></p>
<p>The jackknife RMSE will be calculated as:</p>
<p><span class="math display">\[RMSE_{(j)}  = \sqrt{\frac{(\bar{T}_{(j)} - \theta)^2 + S_{T(j)}^2}{\theta^2}}\]</span></p>
<p>Here <span class="math inline">\(\bar{T}_{(j)}\)</span> and <span class="math inline">\(S^2_{T(j)}\)</span> are calculated as specified above when we described the algebra trick to estimate these values. The MCSE is then calculated as specified in the table below.</p>
<p>Table 2 below shows each of the performance criteria, what it measures, its definition, its estimate, and its MCSE formula.</p>
<table class="table table table-striped table-hover">
<caption>
Table 2. Relative Performance Criteria
</caption>
<thead><tr>
<th style="text-align:left;">
Criterion
</th>
<th style="text-align:left;">
Measure
</th>
<th style="text-align:left;">
Definition
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:left;">
MCSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Relative Bias
</td>
<td style="text-align:left;">
Relative difference from true parameter
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}(T) / \theta\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\bar{T} / \theta\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{S_T^2 / (K\theta^2)}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative MSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}\left[(T - \theta)^2\right]/ \theta^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{(\bar{T} - \theta)^2 + S_T^2}{\theta^2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K\theta^2}\left[S_T^4 (k_T - 1) + 4 S_T^3 g_T(\bar{T} - \theta) + 4 S_T^2 (\bar{T} - \theta)^2\right]}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative RMSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\text{E}\left[(T - \theta)^2\right]/ \theta^2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{(\bar{T} - \theta)^2 + S_T^2}{\theta^2}}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K} \sum_{j=1}^K \left(RMSE_{(j)} - RMSE)^2\right)}\)</span>
</td>
</tr>
</tbody>
</table>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example</h3>
<p>Below, we calculate the relative criteria for the mean difference estimates. Note that when mean difference is 0, the relative measures cannot be calculated. The function returns <code>NA</code> values for conditions where the mean difference is 0. The syntax for <code><a href="../reference/calc_relative.html">calc_relative()</a></code> is similar to the one that we used earlier for <code><a href="../reference/calc_absolute.html">calc_absolute()</a></code>. The <code>perfm_criteria</code> argument allows the user to specify which criteria to evaluate: <code>perfm_criteria = c("relative bias", "relative mse", "relative rmse")</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># using group_modify()</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">welch_res <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">params =</span> mean_diff) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(n, mean_diff, method) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_map.html">group_modify</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/calc_relative.html">calc_relative</a></span>(.x,  <span class="dt">estimates =</span> est, <span class="dt">true_param =</span> params)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="dt">digits =</span> <span class="dv">5</span>)</a></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean_diff
</th>
<th style="text-align:left;">
method
</th>
<th style="text-align:right;">
rel_bias
</th>
<th style="text-align:right;">
rel_bias_mcse
</th>
<th style="text-align:right;">
rel_mse
</th>
<th style="text-align:right;">
rel_mse_mcse
</th>
<th style="text-align:right;">
rel_rmse
</th>
<th style="text-align:right;">
rel_rmse_mcse
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.00898
</td>
<td style="text-align:right;">
0.02051
</td>
<td style="text-align:right;">
0.42055
</td>
<td style="text-align:right;">
0.00234
</td>
<td style="text-align:right;">
0.64850
</td>
<td style="text-align:right;">
0.00046
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.00898
</td>
<td style="text-align:right;">
0.02051
</td>
<td style="text-align:right;">
0.42055
</td>
<td style="text-align:right;">
0.00234
</td>
<td style="text-align:right;">
0.64850
</td>
<td style="text-align:right;">
0.00046
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.00725
</td>
<td style="text-align:right;">
0.00981
</td>
<td style="text-align:right;">
0.09637
</td>
<td style="text-align:right;">
0.00439
</td>
<td style="text-align:right;">
0.31043
</td>
<td style="text-align:right;">
0.00022
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.00725
</td>
<td style="text-align:right;">
0.00981
</td>
<td style="text-align:right;">
0.09637
</td>
<td style="text-align:right;">
0.00439
</td>
<td style="text-align:right;">
0.31043
</td>
<td style="text-align:right;">
0.00022
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.99717
</td>
<td style="text-align:right;">
0.00482
</td>
<td style="text-align:right;">
0.02323
</td>
<td style="text-align:right;">
0.00816
</td>
<td style="text-align:right;">
0.15243
</td>
<td style="text-align:right;">
0.00011
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.99717
</td>
<td style="text-align:right;">
0.00482
</td>
<td style="text-align:right;">
0.02323
</td>
<td style="text-align:right;">
0.00816
</td>
<td style="text-align:right;">
0.15243
</td>
<td style="text-align:right;">
0.00011
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.01071
</td>
<td style="text-align:right;">
0.01443
</td>
<td style="text-align:right;">
0.20833
</td>
<td style="text-align:right;">
0.00118
</td>
<td style="text-align:right;">
0.45643
</td>
<td style="text-align:right;">
0.00033
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.01071
</td>
<td style="text-align:right;">
0.01443
</td>
<td style="text-align:right;">
0.20833
</td>
<td style="text-align:right;">
0.00118
</td>
<td style="text-align:right;">
0.45643
</td>
<td style="text-align:right;">
0.00033
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.99053
</td>
<td style="text-align:right;">
0.00723
</td>
<td style="text-align:right;">
0.05234
</td>
<td style="text-align:right;">
0.00236
</td>
<td style="text-align:right;">
0.22877
</td>
<td style="text-align:right;">
0.00016
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.99053
</td>
<td style="text-align:right;">
0.00723
</td>
<td style="text-align:right;">
0.05234
</td>
<td style="text-align:right;">
0.00236
</td>
<td style="text-align:right;">
0.22877
</td>
<td style="text-align:right;">
0.00016
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.00130
</td>
<td style="text-align:right;">
0.00365
</td>
<td style="text-align:right;">
0.01333
</td>
<td style="text-align:right;">
0.00465
</td>
<td style="text-align:right;">
0.11547
</td>
<td style="text-align:right;">
0.00008
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.00130
</td>
<td style="text-align:right;">
0.00365
</td>
<td style="text-align:right;">
0.01333
</td>
<td style="text-align:right;">
0.00465
</td>
<td style="text-align:right;">
0.11547
</td>
<td style="text-align:right;">
0.00008
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.99770
</td>
<td style="text-align:right;">
0.00996
</td>
<td style="text-align:right;">
0.09912
</td>
<td style="text-align:right;">
0.00053
</td>
<td style="text-align:right;">
0.31483
</td>
<td style="text-align:right;">
0.00021
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.99770
</td>
<td style="text-align:right;">
0.00996
</td>
<td style="text-align:right;">
0.09912
</td>
<td style="text-align:right;">
0.00053
</td>
<td style="text-align:right;">
0.31483
</td>
<td style="text-align:right;">
0.00021
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.98895
</td>
<td style="text-align:right;">
0.00504
</td>
<td style="text-align:right;">
0.02556
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.15987
</td>
<td style="text-align:right;">
0.00011
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.98895
</td>
<td style="text-align:right;">
0.00504
</td>
<td style="text-align:right;">
0.02556
</td>
<td style="text-align:right;">
0.00113
</td>
<td style="text-align:right;">
0.15987
</td>
<td style="text-align:right;">
0.00011
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.00289
</td>
<td style="text-align:right;">
0.00245
</td>
<td style="text-align:right;">
0.00600
</td>
<td style="text-align:right;">
0.00205
</td>
<td style="text-align:right;">
0.07747
</td>
<td style="text-align:right;">
0.00005
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.00289
</td>
<td style="text-align:right;">
0.00245
</td>
<td style="text-align:right;">
0.00600
</td>
<td style="text-align:right;">
0.00205
</td>
<td style="text-align:right;">
0.07747
</td>
<td style="text-align:right;">
0.00005
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="relative-criteria-for-variance-estimators" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-criteria-for-variance-estimators" class="anchor"></a>Relative Criteria for Variance Estimators</h2>
<p>Variances estimators are always positive. Therefore, relative performance criteria are often used to assess variance estimators. For variance estimators, we have <span class="math inline">\(V\)</span> denoting the sampling variance of of a point-estimator <span class="math inline">\(T\)</span>. To assess the relative criteria for <span class="math inline">\(V\)</span>, we need to divide it by the true value of the sampling variance of <span class="math inline">\(T\)</span>, <span class="math inline">\(\lambda = \text{Var}(T)\)</span>, which we may not know. In such scenario, we can use the sample variance of <span class="math inline">\(T\)</span> across the replications, <span class="math inline">\(S_T^2\)</span>, to estimate the true sampling variance.</p>
<p>The relative bias would then be estimated by <span class="math inline">\(RB = \bar{V} / S_T^2\)</span>, the average of the variance estimates divided by the sample variance of the point-estimates. To estimate MCSE of the relative bias of the variance estimator, we need to account for the uncertainty in the estimation of the true sampling variance. One way to do so is to use the jackknife technique that we described above. Jack-knifing involves excluding a replicate <span class="math inline">\(j\)</span> and calculating relative bias <span class="math inline">\(\bar{V}_{(j)}/ S_{T(j)}^2\)</span>. The Monte Carlo standard error can then be calculated as:</p>
<p><span class="math display">\[
MCSE\left(RB\right) = \sqrt{\frac{1}{K} \sum_{j=1}^K \left(RB_{(j)} - RB\right)^2}
\]</span> which can be written as:</p>
<p><span class="math display">\[
MCSE\left(RB\right) = \sqrt{\frac{1}{K} \sum_{j=1}^K \left(\frac{\bar{V}_{(j)}}{S_{T(j)}^2} - \frac{\bar{V}}{S_T^2}\right)^2}
\]</span></p>
<p>We reformulate the MCSE using some algebra tricks similar to how we reformulated them for the RMSE MCSE formulas above.</p>
<p><span class="math display">\[
\begin{aligned}
\bar{V}_{(j)} &amp;= \frac{1}{K - 1}\left(K \bar{V} - V_j\right) \\
S_{T(j)}^2 &amp;= \frac{1}{K - 2} \left[(K - 1) S_T^2 - \frac{K}{K - 1}\left(T_j - \bar{T}\right)^2\right]
\end{aligned}
\]</span></p>
<p>Similarly, we can estimate the MCSE of relative MSE and RMSE using the jackknife technique. To estimate the MSE we need to estimate <span class="math inline">\(S_{V(j)}^2\)</span> which represents the sample variance of the variance estimates leaving replicate <span class="math inline">\(j\)</span> out. We can estimate <span class="math inline">\(S_{V(j)}^2\)</span> as specified below:</p>
<p><span class="math display">\[S_{V(j)}^2 = \frac{1}{K - 2} \left[(K - 1) S_V^2 - \frac{K}{K - 1}\left(V_j - \bar{V}\right)^2\right]\]</span></p>
<p>We can then estimate the jackknife relative MSE and RMSE following the same logic as we described above and then calculate the MCSE.</p>
<p>Table 3 below lists relative performance measures for variance estimators.</p>
<table class="table table table-striped table-hover">
<caption>
Table 3. Relative Performance Criteria for Variance Estimators
</caption>
<thead><tr>
<th style="text-align:left;">
Criterion
</th>
<th style="text-align:left;">
Measure
</th>
<th style="text-align:left;">
Definition
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:left;">
MCSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Relative Bias
</td>
<td style="text-align:left;">
Relative difference from true parameter
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}(V) / \lambda\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\bar{V} / S_T^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K} \sum_{j=1}^K \left(RB_{(j)} - RB\right)^2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative MSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}\left[(V - \lambda)^2\right]/ \lambda^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{(\bar{V} - S_T^2)^2 + S_V^2}{S_T^4}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K} \sum_{j=1}^K \left(MSE_{(j)} - MSE\right)^2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative RMSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\text{E}\left[(V - \lambda)^2\right]/ \lambda^2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{(\bar{V} - S_T^2)^2 + S_V^2}{S_T^4}}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K} \sum_{j=1}^K \left(RMSE_{(j)} - RMSE\right)^2}\)</span>
</td>
</tr>
</tbody>
</table>
<p>The function <code><a href="../reference/calc_relative_var.html">calc_relative_var()</a></code> calculates the relative performance criteria estimate and the jack-knife MCSE of a variance estimator. The function requires <code>res_dat</code>, a data frame or tibble containing simulation results, <code>estimates</code>, the name of the column containing point-estimates, <code>var_estimates</code>, the name of the column containing the variance estimates, and <code>perfm_criteria</code>, the criteria to be evaluated: <code>perfm_criteria = c("relative bias", "relative mse", "relative rmse")</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">welch_res <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">params =</span> mean_diff) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(n, mean_diff, method) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_map.html">group_modify</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/calc_relative_var.html">calc_relative_var</a></span>(.x,  <span class="dt">estimates =</span> est, <span class="dt">var_estimates =</span> var)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="dt">digits =</span> <span class="dv">5</span>)</a></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean_diff
</th>
<th style="text-align:left;">
method
</th>
<th style="text-align:right;">
rel_bias_var
</th>
<th style="text-align:right;">
rel_bias_var_mcse
</th>
<th style="text-align:right;">
rel_mse_var
</th>
<th style="text-align:right;">
rel_mse_var_mcse
</th>
<th style="text-align:right;">
rel_rmse_var
</th>
<th style="text-align:right;">
rel_rmse_var_mcse
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.99449
</td>
<td style="text-align:right;">
0.00135
</td>
<td style="text-align:right;">
0.02941
</td>
<td style="text-align:right;">
0.00008
</td>
<td style="text-align:right;">
0.17148
</td>
<td style="text-align:right;">
0.00024
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.99449
</td>
<td style="text-align:right;">
0.00135
</td>
<td style="text-align:right;">
0.02941
</td>
<td style="text-align:right;">
0.00008
</td>
<td style="text-align:right;">
0.17148
</td>
<td style="text-align:right;">
0.00024
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.95428
</td>
<td style="text-align:right;">
0.00137
</td>
<td style="text-align:right;">
0.02690
</td>
<td style="text-align:right;">
0.00006
</td>
<td style="text-align:right;">
0.16401
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.95428
</td>
<td style="text-align:right;">
0.00137
</td>
<td style="text-align:right;">
0.02690
</td>
<td style="text-align:right;">
0.00006
</td>
<td style="text-align:right;">
0.16401
</td>
<td style="text-align:right;">
0.00019
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.04180
</td>
<td style="text-align:right;">
0.00151
</td>
<td style="text-align:right;">
0.03211
</td>
<td style="text-align:right;">
0.00023
</td>
<td style="text-align:right;">
0.17918
</td>
<td style="text-align:right;">
0.00063
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.04180
</td>
<td style="text-align:right;">
0.00151
</td>
<td style="text-align:right;">
0.03211
</td>
<td style="text-align:right;">
0.00023
</td>
<td style="text-align:right;">
0.17918
</td>
<td style="text-align:right;">
0.00063
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.07309
</td>
<td style="text-align:right;">
0.00151
</td>
<td style="text-align:right;">
0.03487
</td>
<td style="text-align:right;">
0.00031
</td>
<td style="text-align:right;">
0.18672
</td>
<td style="text-align:right;">
0.00083
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.07309
</td>
<td style="text-align:right;">
0.00151
</td>
<td style="text-align:right;">
0.03487
</td>
<td style="text-align:right;">
0.00031
</td>
<td style="text-align:right;">
0.18672
</td>
<td style="text-align:right;">
0.00083
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.01315
</td>
<td style="text-align:right;">
0.00139
</td>
<td style="text-align:right;">
0.01615
</td>
<td style="text-align:right;">
0.00009
</td>
<td style="text-align:right;">
0.12707
</td>
<td style="text-align:right;">
0.00035
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.01315
</td>
<td style="text-align:right;">
0.00139
</td>
<td style="text-align:right;">
0.01615
</td>
<td style="text-align:right;">
0.00009
</td>
<td style="text-align:right;">
0.12707
</td>
<td style="text-align:right;">
0.00035
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.95847
</td>
<td style="text-align:right;">
0.00138
</td>
<td style="text-align:right;">
0.01433
</td>
<td style="text-align:right;">
0.00008
</td>
<td style="text-align:right;">
0.11972
</td>
<td style="text-align:right;">
0.00032
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.95847
</td>
<td style="text-align:right;">
0.00138
</td>
<td style="text-align:right;">
0.01433
</td>
<td style="text-align:right;">
0.00008
</td>
<td style="text-align:right;">
0.11972
</td>
<td style="text-align:right;">
0.00032
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.95359
</td>
<td style="text-align:right;">
0.00137
</td>
<td style="text-align:right;">
0.01450
</td>
<td style="text-align:right;">
0.00009
</td>
<td style="text-align:right;">
0.12041
</td>
<td style="text-align:right;">
0.00037
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.95359
</td>
<td style="text-align:right;">
0.00137
</td>
<td style="text-align:right;">
0.01450
</td>
<td style="text-align:right;">
0.00009
</td>
<td style="text-align:right;">
0.12041
</td>
<td style="text-align:right;">
0.00037
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.94143
</td>
<td style="text-align:right;">
0.00131
</td>
<td style="text-align:right;">
0.01572
</td>
<td style="text-align:right;">
0.00012
</td>
<td style="text-align:right;">
0.12538
</td>
<td style="text-align:right;">
0.00047
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.94143
</td>
<td style="text-align:right;">
0.00131
</td>
<td style="text-align:right;">
0.01572
</td>
<td style="text-align:right;">
0.00012
</td>
<td style="text-align:right;">
0.12538
</td>
<td style="text-align:right;">
0.00047
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.96861
</td>
<td style="text-align:right;">
0.00134
</td>
<td style="text-align:right;">
0.00768
</td>
<td style="text-align:right;">
0.00006
</td>
<td style="text-align:right;">
0.08764
</td>
<td style="text-align:right;">
0.00036
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.96861
</td>
<td style="text-align:right;">
0.00134
</td>
<td style="text-align:right;">
0.00768
</td>
<td style="text-align:right;">
0.00006
</td>
<td style="text-align:right;">
0.08764
</td>
<td style="text-align:right;">
0.00036
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.01134
</td>
<td style="text-align:right;">
0.00137
</td>
<td style="text-align:right;">
0.00785
</td>
<td style="text-align:right;">
0.00006
</td>
<td style="text-align:right;">
0.08862
</td>
<td style="text-align:right;">
0.00033
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.01134
</td>
<td style="text-align:right;">
0.00137
</td>
<td style="text-align:right;">
0.00785
</td>
<td style="text-align:right;">
0.00006
</td>
<td style="text-align:right;">
0.08862
</td>
<td style="text-align:right;">
0.00033
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.98250
</td>
<td style="text-align:right;">
0.00139
</td>
<td style="text-align:right;">
0.00675
</td>
<td style="text-align:right;">
0.00003
</td>
<td style="text-align:right;">
0.08217
</td>
<td style="text-align:right;">
0.00017
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.98250
</td>
<td style="text-align:right;">
0.00139
</td>
<td style="text-align:right;">
0.00675
</td>
<td style="text-align:right;">
0.00003
</td>
<td style="text-align:right;">
0.08217
</td>
<td style="text-align:right;">
0.00017
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.04149
</td>
<td style="text-align:right;">
0.00142
</td>
<td style="text-align:right;">
0.00879
</td>
<td style="text-align:right;">
0.00014
</td>
<td style="text-align:right;">
0.09375
</td>
<td style="text-align:right;">
0.00075
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.04149
</td>
<td style="text-align:right;">
0.00142
</td>
<td style="text-align:right;">
0.00879
</td>
<td style="text-align:right;">
0.00014
</td>
<td style="text-align:right;">
0.09375
</td>
<td style="text-align:right;">
0.00075
</td>
</tr>
</tbody>
</table>
</div>
<div id="hypothesis-testing-and-confidence-intervals" class="section level2">
<h2 class="hasAnchor">
<a href="#hypothesis-testing-and-confidence-intervals" class="anchor"></a>Hypothesis Testing and Confidence Intervals</h2>
<p>When doing hypothesis tests, we are often interested in whether Type 1 error rate is adequately controlled and whether the test has enough power to detect the effect of interest. Rejection rate captures the proportion of times the p-value is below a specified <span class="math inline">\(\alpha\)</span> level, the proportion of times we can reject the null hypothesis. When the specified effect size is 0, we can examine Type 1 error rates and when the magnitude of the effect is greater than 0, we can examine power. We are also interested in confidence interval coverage, proportion of intervals that contain the true parameter, and the interval width, which is an indicator of the precision of the estimate.</p>
<p>Table 4 below presents the performance criteria used to evaluate hypothesis tests. In the table, let <span class="math inline">\(P_k\)</span> denote the p-value from simulation replication <span class="math inline">\(k\)</span>, for <span class="math inline">\(k = 1,...,K\)</span>. Suppose that the confidence intervals are for the target parameter <span class="math inline">\(\theta\)</span> and have coverage level <span class="math inline">\(\beta\)</span>. Let <span class="math inline">\(A_k\)</span> and <span class="math inline">\(B_k\)</span> denote the lower and upper end-points of the confidence interval from simulation replication <span class="math inline">\(k\)</span>, and let <span class="math inline">\(W_k = B_k − A_k\)</span>, all for <span class="math inline">\(k = 1,...,K\)</span>.</p>
<table class="table table table-striped table-hover">
<caption>
Table 4. Hypothesis Testing and Confidence Intervals Performance Criteria
</caption>
<thead><tr>
<th style="text-align:left;">
Criterion
</th>
<th style="text-align:left;">
Measure
</th>
<th style="text-align:left;">
Definition
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:left;">
MCSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rejection Rate
</td>
<td style="text-align:left;">
Type 1 Error or Power
</td>
<td style="text-align:left;">
<span class="math inline">\(\rho_\alpha = Pr(P_k) &lt; \alpha\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(r_\alpha = \frac{1}{K} \sum_{k=1}^K I(P_k &lt; \alpha)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{r_\alpha(1 - r_\alpha) / K}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Coverage
</td>
<td style="text-align:left;">
Proportion of intervals containing true parameter
</td>
<td style="text-align:left;">
<span class="math inline">\(\omega_\beta = Pr(A \leq \theta \leq B)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(c_\beta = \frac{1}{K}\sum_{k=1}^K I(A_k \leq \theta \leq B_k)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{c_\beta (1 - c_\beta) / K}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Width
</td>
<td style="text-align:left;">
Precision
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}(W) = \text{E}(B - A)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\bar{W} = \bar{B} - \bar{A}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{S_W^2 / K}\)</span>
</td>
</tr>
</tbody>
</table>
<div id="example-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example</h3>
<p>Below we calculate the rejection rates for the hypothesis tests conducted using t-test. The null hypothesis states that the two groups have the same means. The <code><a href="../reference/calc_rejection.html">calc_rejection()</a></code> function requires a data frame or tibble containing simulation results as the first argument. The second argument, <code>p_values</code>, requires the name of the column containing p-values. The third argument, <code>alpha</code> lets the user specify a value for <span class="math inline">\(\alpha\)</span>. The default value is set to the conventional 0.05.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># using group_modify()</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">welch_res <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(n, mean_diff, method) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_map.html">group_modify</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/calc_rejection.html">calc_rejection</a></span>(.x, <span class="dt">p_values =</span> p_val)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="dt">digits =</span> <span class="dv">5</span>)</a></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean_diff
</th>
<th style="text-align:left;">
method
</th>
<th style="text-align:right;">
rej_rate
</th>
<th style="text-align:right;">
rej_rate_mcse
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.048
</td>
<td style="text-align:right;">
0.00676
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.047
</td>
<td style="text-align:right;">
0.00669
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.363
</td>
<td style="text-align:right;">
0.01521
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.362
</td>
<td style="text-align:right;">
0.01520
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.885
</td>
<td style="text-align:right;">
0.01009
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.883
</td>
<td style="text-align:right;">
0.01016
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.040
</td>
<td style="text-align:right;">
0.00620
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.040
</td>
<td style="text-align:right;">
0.00620
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.622
</td>
<td style="text-align:right;">
0.01533
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.620
</td>
<td style="text-align:right;">
0.01535
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.992
</td>
<td style="text-align:right;">
0.00282
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.992
</td>
<td style="text-align:right;">
0.00282
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.053
</td>
<td style="text-align:right;">
0.00708
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.053
</td>
<td style="text-align:right;">
0.00708
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.888
</td>
<td style="text-align:right;">
0.00997
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.886
</td>
<td style="text-align:right;">
0.01005
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
</tbody>
</table>
<p>Below we calculate the confidence interval coverage rates and widths for the estimates of the mean difference. The <code><a href="../reference/calc_coverage.html">calc_coverage()</a></code> function requires a data frame or tibble containing the simulation results as the first argument. The second and third arguments, <code>lower_bound</code> and <code>upper_bound</code>, take in the name of the columns that contain the lower and upper bound estimates of the confidence interval. The <code>true_param</code> argument requires the name of the column containing the true parameters. Like <code><a href="../reference/calc_absolute.html">calc_absolute()</a></code>, <code><a href="../reference/calc_relative.html">calc_relative()</a></code> and <code><a href="../reference/calc_relative_var.html">calc_relative_var()</a></code>, <code><a href="../reference/calc_coverage.html">calc_coverage()</a></code> also has an argument, <code>perfm_criteria</code>, where the user can specify which criteria to evaluate: <code>perfm_criteria = c("coverage", "width")</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># using group_modify()</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">welch_res <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">params =</span> mean_diff) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(n, mean_diff, method) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_map.html">group_modify</a></span>(<span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/calc_coverage.html">calc_coverage</a></span>(.x, <span class="dt">lower_bound =</span> lower_bound, <span class="dt">upper_bound =</span> upper_bound, <span class="dt">true_param =</span> params)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="dt">digits =</span> <span class="dv">5</span>)</a></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean_diff
</th>
<th style="text-align:left;">
method
</th>
<th style="text-align:right;">
coverage
</th>
<th style="text-align:right;">
coverage_mcse
</th>
<th style="text-align:right;">
width
</th>
<th style="text-align:right;">
width_mcse
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.952
</td>
<td style="text-align:right;">
0.00676
</td>
<td style="text-align:right;">
1.24697
</td>
<td style="text-align:right;">
0.00338
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.953
</td>
<td style="text-align:right;">
0.00669
</td>
<td style="text-align:right;">
1.25266
</td>
<td style="text-align:right;">
0.00343
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.948
</td>
<td style="text-align:right;">
0.00702
</td>
<td style="text-align:right;">
1.25276
</td>
<td style="text-align:right;">
0.00328
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.949
</td>
<td style="text-align:right;">
0.00696
</td>
<td style="text-align:right;">
1.25854
</td>
<td style="text-align:right;">
0.00332
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.958
</td>
<td style="text-align:right;">
0.00634
</td>
<td style="text-align:right;">
1.25287
</td>
<td style="text-align:right;">
0.00331
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.959
</td>
<td style="text-align:right;">
0.00627
</td>
<td style="text-align:right;">
1.25859
</td>
<td style="text-align:right;">
0.00335
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.958
</td>
<td style="text-align:right;">
0.00634
</td>
<td style="text-align:right;">
1.24914
</td>
<td style="text-align:right;">
0.00317
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.958
</td>
<td style="text-align:right;">
0.00634
</td>
<td style="text-align:right;">
1.25488
</td>
<td style="text-align:right;">
0.00322
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.960
</td>
<td style="text-align:right;">
0.00620
</td>
<td style="text-align:right;">
0.88108
</td>
<td style="text-align:right;">
0.00173
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.960
</td>
<td style="text-align:right;">
0.00620
</td>
<td style="text-align:right;">
0.88303
</td>
<td style="text-align:right;">
0.00174
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.949
</td>
<td style="text-align:right;">
0.00696
</td>
<td style="text-align:right;">
0.87945
</td>
<td style="text-align:right;">
0.00163
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.950
</td>
<td style="text-align:right;">
0.00689
</td>
<td style="text-align:right;">
0.88139
</td>
<td style="text-align:right;">
0.00164
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.942
</td>
<td style="text-align:right;">
0.00739
</td>
<td style="text-align:right;">
0.87886
</td>
<td style="text-align:right;">
0.00162
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.942
</td>
<td style="text-align:right;">
0.00739
</td>
<td style="text-align:right;">
0.88080
</td>
<td style="text-align:right;">
0.00163
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.931
</td>
<td style="text-align:right;">
0.00801
</td>
<td style="text-align:right;">
0.88214
</td>
<td style="text-align:right;">
0.00164
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.931
</td>
<td style="text-align:right;">
0.00801
</td>
<td style="text-align:right;">
0.88413
</td>
<td style="text-align:right;">
0.00165
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.947
</td>
<td style="text-align:right;">
0.00708
</td>
<td style="text-align:right;">
0.62166
</td>
<td style="text-align:right;">
0.00083
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.947
</td>
<td style="text-align:right;">
0.00708
</td>
<td style="text-align:right;">
0.62234
</td>
<td style="text-align:right;">
0.00083
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.955
</td>
<td style="text-align:right;">
0.00656
</td>
<td style="text-align:right;">
0.62183
</td>
<td style="text-align:right;">
0.00085
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.955
</td>
<td style="text-align:right;">
0.00656
</td>
<td style="text-align:right;">
0.62252
</td>
<td style="text-align:right;">
0.00086
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.944
</td>
<td style="text-align:right;">
0.00727
</td>
<td style="text-align:right;">
0.62104
</td>
<td style="text-align:right;">
0.00080
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.944
</td>
<td style="text-align:right;">
0.00727
</td>
<td style="text-align:right;">
0.62173
</td>
<td style="text-align:right;">
0.00080
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
t-test
</td>
<td style="text-align:right;">
0.957
</td>
<td style="text-align:right;">
0.00641
</td>
<td style="text-align:right;">
0.62076
</td>
<td style="text-align:right;">
0.00079
</td>
</tr>
<tr>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
Welch t-test
</td>
<td style="text-align:right;">
0.957
</td>
<td style="text-align:right;">
0.00641
</td>
<td style="text-align:right;">
0.62144
</td>
<td style="text-align:right;">
0.00079
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="how-to-evaluate-mcse" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-evaluate-mcse" class="anchor"></a>How to evaluate MCSE</h1>
<p>The associated MCSE should be small compared to the performance measure. Below is an example from Frane (2015) of how to write up MCSE results as part of simulation study results. Frane (2015) compared various methods to control Type 1 error rates when conducting analysis on multiple outcome variables.</p>
<p>“Only Bonferroni and MP strictly controlled the PFER; the observed maximum PFER was 0.050 for Bonferroni, 0.051 for Sidák, 0.061 for Holm, 0.100 for Hochberg, and 0.050 for MP (estimated SE ≤ 0.0002 for all estimates).”</p>
<p>The PFER refers to per family error rate, the expected number of Type 1 errors out of <span class="math inline">\(m\)</span> comparisons. MP refers to MANOVA protected tests. The SE refers to the MCSE. The number of replications was 1,000,000 in Frane (2015). We note that the number is quite high and generally 1,000 to 10,000 replications are enough. The resulting MCSEs in Frane (2015) therefore are way smaller compared to the values for PFER.</p>
<p>For more information for performance criteria and MCSE, we recommend Morris, White &amp; Crowther (2018).</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Frane, A. V. (2015). Power and Type I Error Control for Univariate Comparisons in Multivariate Two-Group Designs. Multivariate Behavioral Research, 50(2), 233–247. <a href="http://doi.org/10.1080/00273171.2014.968836" class="uri">http://doi.org/10.1080/00273171.2014.968836</a></p>
<p>Morris, T. P., White, I. R., &amp; Crowther, M. J. (2019). Using simulation studies to evaluate statistical methods. Statistics in medicine, 38(11), 2074-2102. <a href="http://doi.org/10.1002/sim.8086" class="uri">http://doi.org/10.1002/sim.8086</a></p>
<p>Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686, <a href="https://doi.org/10.21105/joss.01686" class="uri">https://doi.org/10.21105/joss.01686</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-to-simulation-studies-and-monte-carlo-standard-errors">Introduction to Simulation Studies and Monte Carlo Standard Errors</a></li>
      <li>
<a href="#performance-criteria-and-mcse">Performance Criteria and MCSE</a><ul class="nav nav-pills nav-stacked">
<li><a href="#absolute-criteria">Absolute Criteria</a></li>
      <li><a href="#relative-criteria">Relative Criteria</a></li>
      <li><a href="#relative-criteria-for-variance-estimators">Relative Criteria for Variance Estimators</a></li>
      <li><a href="#hypothesis-testing-and-confidence-intervals">Hypothesis Testing and Confidence Intervals</a></li>
      </ul>
</li>
      <li><a href="#how-to-evaluate-mcse">How to evaluate MCSE</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://meghapsimatrix.com">Megha Joshi</a>, <a href="https://www.jepusto.com/">James E. Pustejovsky</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'f4d0d6658ae25a0f79f8db12ee660be0',
    indexName: 'simhelpers',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
